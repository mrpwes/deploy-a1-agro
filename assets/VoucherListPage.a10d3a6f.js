import{Q as g}from"./QTd.312e33a5.js";import{r as c,o as w,c as _,d as a,Q as p,w as n,a as s,f as k,S as V,aa as f,u as $,at as C,au as b,e as y,G as x}from"./index.4b3c3d71.js";import{Q as m}from"./QInput.0b7d6fff.js";import{Q}from"./QTable.7eaf985e.js";import{d as I}from"./date.eeec251e.js";import{u as Y}from"./pageHeader.5864d687.js";import{Q as v}from"./QSelect.719db4c9.js";import{Q as S,C as j}from"./ClosePopup.261790f7.js";import{Q as B}from"./QForm.2888d044.js";import{Q as A}from"./QDialog.f2508d6d.js";import"./use-key-composition.58a46558.js";import"./focus-manager.f3c2b9a5.js";import"./QList.bb366341.js";import"./position-engine.65eff008.js";const q={class:"!tw-h-min !tw-w-4/12 !tw-max-w-full tw-bg-white tw-p-6 tw-pb-3"},E={class:"tw-grid tw-gap-3"},L=s("div",{class:"tw-text-3xl tw-font-extrabold"},"Add Voucher",-1),M={class:"tw-flex tw-justify-between"},P={class:"tw-flex"},R=s("div",{class:"tw-my-auto"},"Subject:",-1),O=s("div",{class:"tw-w-2"},null,-1),N={class:"tw-w-36"},T=s("span",{class:"tw-text-gray-500"},"(Optional)",-1),F={class:"tw-flex tw-justify-between"},H={class:"tw-flex"},G=s("div",{class:"tw-my-auto"},"Date Issued:",-1),W=s("div",{class:"tw-w-2"},null,-1),z={class:"tw-flex"},J=s("div",{class:"tw-my-auto"},"Amount:",-1),K=s("div",{class:"tw-w-2"},null,-1),D={__name:"ViewVoucherButton",props:["rows"],setup(i){const o=c(!1),t=c(null);function d(r){t.value=r,o.value=!0,t.value.issuer_name=r.issuer.company_employee_id+" - "+r.issuer.last_name+", "+r.issuer.first_name+" "+r.issuer.middle_name,t.value.recipient_name=r.issuer.company_employee_id+" - "+r.recipient.last_name+", "+r.recipient.first_name+" "+r.recipient.middle_name}return(r,e)=>(w(),_(f,null,[a(p,{style:{"flex-wrap":"nowrap !important"},icon:"visibility",label:"VIEW",onClick:e[0]||(e[0]=l=>d(i.rows))}),a(A,{modelValue:o.value,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value=l),persistent:""},{default:n(()=>[s("div",q,[a(B,{autofocus:""},{default:n(()=>[s("div",E,[L,s("div",M,[s("div",null,[a(v,{rounded:"",standout:"bg-teal text-white",modelValue:t.value.recipient_name,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.recipient_name=l),label:"Recipient",readonly:"",autogrow:""},null,8,["modelValue"])]),s("div",null,[a(v,{rounded:"",standout:"bg-teal text-white",modelValue:t.value.issuer_name,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.issuer_name=l),label:"Issuer",readonly:"",autogrow:""},null,8,["modelValue"])])]),s("div",P,[R,O,s("div",N,[a(m,{rounded:"",standout:"bg-teal text-white",modelValue:t.value.subject,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.subject=l),readonly:"",autogrow:"",type:"text",required:""},null,8,["modelValue"])])]),s("div",null,[k(" Description: "),T,a(m,{rounded:"",standout:"bg-teal text-white",modelValue:t.value.description,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.description=l),readonly:"",autogrow:"",type:"text"},null,8,["modelValue"])]),s("div",F,[s("div",H,[G,W,a(m,{rounded:"",standout:"bg-teal text-white",modelValue:t.value.date_issued,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.date_issued=l),"aria-required":"",type:"date","hide-bottom-space":"",readonly:""},null,8,["modelValue"])]),s("div",z,[J,K,a(m,{rounded:"",standout:"bg-teal text-white",modelValue:t.value.amount,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.amount=l),readonly:"",dense:r.dense,"hide-bottom-space":"",type:"number",required:""},null,8,["modelValue","dense"])])])]),a(S,{align:"right"},{default:n(()=>[V(a(p,{flat:"",label:"CLOSE"},null,512),[[j]])]),_:1})]),_:1})])]),_:1},8,["modelValue"])],64))}},h=$(),U=C("emp_viewVoucher",{state:()=>({rows:[]}),getters:{getActive(i){return i.rows.filter(o=>o.is_archive===!1&&o.recipient.id===h.getEmployeeId)},getInactive(i){return i.rows.filter(o=>o.is_archive===!0&&o.recipient.id===h.getEmployeeId)}},actions:{async fetchListOfVouchers(){try{const{data:i,error:o}=await b.from("voucher").select(`
              id,
              admin_employee_id(company_employee_id, first_name, middle_name, last_name),
              subject,
              description,
              date_issued,
              recipient(id, company_employee_id, first_name, middle_name, last_name),
              issuer(company_employee_id, first_name, middle_name, last_name), 
              amount,
              is_archive
            `);if(o)throw o;this.rows=i}catch(i){console.log(i)}},async archivedVoucher(i,o){try{const{data:t,error:d}=await b.from("voucher").update({is_archive:!o}).eq("id",i);if(d)throw d;console.log(t),this.fetchListOfVouchers()}catch(t){console.log(t)}}}}),X={class:"!tw-h-min !tw-w-8/12 !tw-max-w-full tw-bg-white tw-p-6"},Z=s("div",{class:"tw-col-span-4 tw-text-3xl tw-font-extrabold tw-pb-3"}," Archived Voucher ",-1),ee={__name:"ArchivedVoucherButton",setup(i){const o=U(),t=c(!1),d=c(""),r=[{name:"id",required:!0,label:"Voucher Id",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"subject",align:"center",label:"Subject",field:"subject",sortable:!0},{name:"Date",align:"center",label:"Date",field:e=>e.date_issued,format:e=>I.formatDate(e,"MMM D, YYYY"),sortable:!0},{name:"Recipient",align:"center",label:"Recipient",field:e=>e.recipient.last_name+" "+e.recipient.first_name,sortable:!0},{name:"Issuer",align:"center",label:"Issuer",field:e=>e.issuer.last_name+" "+e.issuer.first_name,sortable:!0},{name:"Amount",align:"center",label:"Amount",field:"amount",sortable:!0},{name:"actions",align:"center",label:"",field:""}];return(e,l)=>(w(),_(f,null,[a(p,{icon:"mdi-archive",label:"Archived Voucher",onClick:l[0]||(l[0]=u=>t.value=!0),class:"tw-bg-white"}),a(A,{modelValue:t.value,"onUpdate:modelValue":l[2]||(l[2]=u=>t.value=u),persistent:""},{default:n(()=>[s("div",X,[Z,a(Q,{class:"my-sticky-header-table tw-w-11/12 tw-mx-auto tw-mt-6 tw-bg-white tw-shadow-lg tw-border tw-rounded-3xl tw-border-collapse",flat:"",bordered:"",filter:d.value,columns:r,rows:y(o).getInactive,"rows-per-page-options":[10,20,0],"row-key":"name"},{"body-cell-actions":n(u=>[a(g,{props:u},{default:n(()=>[s("div",null,[a(D,{rows:u.row},null,8,["rows"])])]),_:2},1032,["props"])]),"top-right":n(()=>[a(m,{borderless:"",dense:"",debounce:"300",modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=u=>d.value=u),placeholder:"Search"},{append:n(()=>[a(x,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["filter","rows"]),a(S,{align:"right",class:"text-primary"},{default:n(()=>[V(a(p,{flat:"",label:"Cancel"},null,512),[[j]])]),_:1})])]),_:1},8,["modelValue"])],64))}},te={class:"tw-w-11/12 tw-mx-auto tw-flex tw-justify-end tw-mb-5 tw-gap-4"},fe={__name:"VoucherListPage",setup(i){const o=Y();o.currentPage="Voucher List";const t=c(""),d=U();d.fetchListOfVouchers();const r=[{name:"id",required:!0,label:"Voucher Id",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"subject",align:"center",label:"Subject",field:"subject",sortable:!0},{name:"Date",align:"center",label:"Date",field:e=>e.date_issued,format:e=>I.formatDate(e,"MMM D, YYYY"),sortable:!0},{name:"Recipient",align:"center",label:"Recipient",field:e=>e.recipient.last_name+" "+e.recipient.first_name,sortable:!0},{name:"Issuer",align:"center",label:"Issuer",field:e=>e.issuer.last_name+" "+e.issuer.first_name,sortable:!0},{name:"Amount",align:"center",label:"Amount",field:"amount",sortable:!0},{name:"actions",align:"center",label:"",field:""}];return(e,l)=>(w(),_(f,null,[s("div",te,[a(ee)]),a(Q,{class:"my-sticky-header-table tw-w-11/12 tw-mx-auto tw-mt-6 tw-bg-white tw-shadow-lg tw-border tw-rounded-3xl tw-border-collapse",flat:"",bordered:"",filter:t.value,columns:r,rows:y(d).getActive,"rows-per-page-options":[10,20,0],"row-key":"name"},{"body-cell-actions":n(u=>[a(g,{key:"actions",class:"tw-w-2/12",props:u},{default:n(()=>[a(D,{rows:u.row},null,8,["rows"])]),_:2},1032,["props"])]),"top-right":n(()=>[a(m,{borderless:"",dense:"",debounce:"300",modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=u=>t.value=u),placeholder:"Search"},{append:n(()=>[a(x,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["filter","rows"])],64))}};export{fe as default};
