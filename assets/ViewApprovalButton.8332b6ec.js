import{u as V,ar as P,as as m,r as _,o as r,c as d,d as s,Q as c,w as n,a as o,a8 as f,g as v,a5 as h,a6 as Q,G as R,S as y}from"./index.504ec86a.js";import{u as T}from"./globalNotification.5d4f7813.js";import{Q as w}from"./QInput.83dad3fc.js";import{Q as A}from"./QDate.4981f917.js";import{Q as D}from"./QPopupProxy.7af26239.js";import{C as g,Q as C}from"./ClosePopup.337d1baa.js";import{Q as I}from"./position-engine.224580a6.js";import{u as S}from"./viewApproval.4c4ccb4a.js";const q=T(),b=V(),Z=P("requestToAdminPage",{state:()=>({request_type_id:0,request_subject:"",request_description:"",request_file_attachment:"",request_application_date:"",admin_employee_id:0,admin_comments:"",admin_confirmation_date:"",change_date:"",viewPrompt:!1,requestTypeOption:null,requestTypeOptions:["Leave","Maternity Leave","Paternity Leave","BIR 2316"],rows:[],columns:[{name:"id",align:"center",label:"Request ID",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"type",align:"center",label:"Type",field:e=>e.type===1?"Leave":e.type===2?"Maternity Leave":e.type===3?"Paternity Leave":e.type===4?"BIR 2316":null,sortable:!0},{name:"request_type_name",align:"center",label:"Description",field:e=>e.description,format:e=>`${e}`,sortable:!0},{name:"status",align:"center",label:"Status",field:e=>{if(e.is_approved===null)return"Pending";if(e.is_approved===!0)return"Approved - "+e.admin_id.first_name+" "+e.admin_id.last_name;if(e.is_approved===!1)return"Declined"},format:e=>`${e}`,sortable:!0},{name:"actions",align:"center",label:""}],dateList:[{}],selectedDate:""}),getters:{getUnarchiveRows(){return this.rows.sort((e,t)=>e.id-t.id)}},actions:{addField(e,t){this.dateList.push({})},removeField(e,t){this.dateList.splice(e,1)},async addRequestToAdminPage(){try{const{data:e,error:t}=await m.from("leave_request").insert({type:this.requestTypeOption==="Leave"?1:this.requestTypeOption==="Maternity Leave"?2:this.requestTypeOption==="Paternity Leave"?3:this.requestTypeOption==="BIR 2316"?4:null,employee_id:b.getEmployeeId,description:this.request_description,date_list:this.dateList,is_approved:null});if(t)throw t;this.resetForm(),this.viewPrompt=!1,q.showSuccessNotification("Request sent successfully"),this.getRequestList()}catch(e){console.error("error",e),q.showErrorNotification("Failed to send request. Please try again later.")}},resetForm(){this.request_subject="",this.request_description="",this.request_file_attachment="",this.request_application_date="",this.requestTypeOption=null},async getRequestList(){const{data:e,error:t}=await m.from("leave_request").select("*, admin_id(first_name, last_name)").eq("employee_id",b.getEmployeeId).order("id",{ascending:!1});this.rows=e}}}),B={class:"!tw-h-min !tw-w-4/12 !tw-max-w-full tw-bg-white tw-p-6"},k={class:"tw-grid tw-grid-cols-3 tw-gap-5 tw-pb-5"},N={class:"tw-col-span-3"},O={key:0},U=o("div",{class:"tw-col-span-3"},"Description:",-1),F={class:"tw-col-span-3"},x={key:1},E=o("div",{class:"tw-col-span-3"},"Leave Request Contents:",-1),$={class:"tw-col-span-1"},j=["dense"],M={class:"row items-center justify-end"},ee={__name:"ViewApprovalButton",props:["rows"],setup(e){V(),S();const t=_(!1),i=_(null);function L(u){i.value=u,t.value=!0}return(u,l)=>(r(),d(h,null,[s(c,{icon:"visibility",label:"View",onClick:l[0]||(l[0]=a=>L(e.rows))}),s(I,{modelValue:t.value,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value=a)},{default:n(()=>[o("div",B,[o("div",k,[o("div",N,"Request ID: "+f(i.value.id),1),i.value.admin_id?(r(),d("div",O," Admin: "+f(i.value.admin_id.last_name+", "+i.value.admin_id.first_name+" "),1)):v("",!0),U,o("div",F,[s(w,{dense:u.dense,modelValue:i.value.description,"onUpdate:modelValue":l[1]||(l[1]=a=>i.value.description=a),disable:"",autogrow:"",filled:"","hide-bottom-space":""},null,8,["dense","modelValue"])]),i.value.type!==4?(r(),d("div",x,[E,o("div",$,[(r(!0),d(h,null,Q(i.value.date_list,a=>(r(),d("div",{key:a,dense:u.dense,disable:"",autogrow:"",filled:"","hide-bottom-space":""},[s(w,{filled:"",modelValue:a.date,"onUpdate:modelValue":p=>a.date=p,mask:"date",rules:["date"],disable:""},{append:n(()=>[s(R,{name:"event",class:"cursor-pointer"},{default:n(()=>[s(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[s(A,{modelValue:a.date,"onUpdate:modelValue":p=>a.date=p},{default:n(()=>[o("div",M,[y(s(c,{label:"Close",color:"primary",flat:""},null,512),[[g]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])],8,j))),128))])])):v("",!0)]),s(C,{align:"right",class:"text-primary"},{default:n(()=>[y(s(c,{flat:"",label:"Close"},null,512),[[g]])]),_:1})])]),_:1},8,["modelValue"])],64))}};export{ee as _,Z as u};
