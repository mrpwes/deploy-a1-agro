import{ar as A,as as m,r as _,o as w,c as V,d as r,Q as n,w as g,a as l,a5 as u,e as c,V as p,a4 as h,g as b,n as y,a7 as k}from"./index.2557495e.js";import{Q as f}from"./QInput.9f633af0.js";import{Q as C,C as v}from"./ClosePopup.35a1fdfa.js";import{Q as D}from"./position-engine.76115753.js";import{d as Q}from"./date.efd68641.js";const S=A("viewApproval",{state:()=>({rows:[]}),getters:{getArchivedApprovalList(s){return s.rows.filter(a=>a.is_archive===!0)},getUnarchivedApprovalList(s){return s.rows.filter(a=>a.is_archive===!1)}},actions:{async getApprovalList(){try{const{data:s,error:a}=await m.from("request").select(`
            id,
            recipient:employee (id, first_name, middle_name, last_name),
            request_type_id,
            request_date,
            subject,
            description,
            remarks,
            is_archive,
            request_confirmation (
                id,
                employee_id,
                application_date,
                request_confirmation_date,
                status,
                remarks,
                is_archive
            )        
        `).eq("request_type_id",3);if(a)throw a;this.rows=s,this.getApprovalList()}catch(s){console.log(s)}},async archivedRequest(s,a){try{const{error:o}=await m.from("request").update({is_archive:!a}).eq("id",s);if(o)throw o;this.getApprovalList()}catch(o){console.log(o)}},async requestConfirmationStatus(s,a){try{const{error:o}=await m.from("request_confirmation").update({status:a==="Approved"?"Disapproved":"Approved"}).eq("id",s);if(o)throw o;this.getApprovalList()}catch(o){console.log(o)}}}}),B={class:"!tw-h-min !tw-w-4/12 !tw-max-w-full tw-bg-white tw-p-6"},L={class:"tw-grid tw-grid-cols-3 tw-gap-5 tw-pb-5"},U=l("div",{class:"tw-col-span-3"},"Subject:",-1),R={class:"tw-col-span-3"},j=l("div",{class:"tw-col-span-3"},"Description:",-1),N={class:"tw-col-span-3"},P=l("div",{class:"tw-col-span-3"},"Remarks:",-1),Y={class:"tw-col-span-3 !tw-h-2/6"},E={__name:"ViewApprovalButton",props:["rows"],setup(s){const a=S(),o=_(!1),e=_(null);function q(d){e.value=d,o.value=!0}return(d,t)=>(w(),V(k,null,[r(n,{icon:"visibility",label:"View",onClick:t[0]||(t[0]=i=>q(s.rows))}),r(D,{modelValue:o.value,"onUpdate:modelValue":t[7]||(t[7]=i=>o.value=i)},{default:g(()=>[l("div",B,[l("div",L,[l("div",null,"Request ID: "+u(e.value.id),1),l("div",null," Name: "+u(e.value.recipient.first_name)+" "+u(e.value.recipient.last_name),1),l("div",null," Application Date: "+u(c(Q).formatDate(e.value.request_confirmation.application_date,"MMM D, YYYY")),1),U,l("div",R,[r(f,{dense:d.dense,modelValue:e.value.subject,"onUpdate:modelValue":t[1]||(t[1]=i=>e.value.subject=i),disable:"",autogrow:"",filled:"","hide-bottom-space":""},null,8,["dense","modelValue"])]),j,l("div",N,[r(f,{dense:d.dense,modelValue:e.value.description,"onUpdate:modelValue":t[2]||(t[2]=i=>e.value.description=i),disable:"",autogrow:"",filled:"","hide-bottom-space":""},null,8,["dense","modelValue"])]),P,l("div",Y,[r(f,{modelValue:e.value.remarks,"onUpdate:modelValue":t[3]||(t[3]=i=>e.value.remarks=i),filled:"",autogrow:"",disable:!!e.value.isArchive,readonly:!!e.value.isArchive},null,8,["modelValue","disable","readonly"])])]),r(C,{align:"right",class:"text-primary"},{default:g(()=>[p(r(n,{flat:"",label:"Cancel"},null,512),[[v]]),e.value.request_confirmation.status=="Pending"?p((w(),h(n,{key:0,flat:"",class:"tw-bg-red-500",icon:"mdi-close",label:"Disapprove",onClick:t[4]||(t[4]=i=>c(a).requestConfirmationStatus(e.value.request_confirmation.id,"Disapproved"))},null,512)),[[v]]):b("",!0),e.value.request_confirmation.status=="Pending"?p((w(),h(n,{key:1,flat:"",class:"tw-bg-green-400",icon:"mdi-check-bold",label:"Approve",onClick:t[5]||(t[5]=i=>c(a).requestConfirmationStatus(e.value.request_confirmation.id,"Approved"))},null,512)),[[v]]):b("",!0),p(r(n,{flat:"",class:y(e.value.is_archive?"tw-bg-green-400":"tw-bg-red-400"),icon:"mdi-archive",label:e.value.is_archive?"Unarchive":"Archive",onClick:t[6]||(t[6]=i=>c(a).archivedRequest(e.value.id,e.value.is_archive))},null,8,["class","label"]),[[v]])]),_:1})])]),_:1},8,["modelValue"])],64))}};export{E as _,S as u};
